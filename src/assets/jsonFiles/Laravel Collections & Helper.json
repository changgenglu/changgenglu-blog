{"name":"Laravel Collections & Helper.md","content":"# Laravel Collections & Helper\n\n>\n\n## Collections 集合\n\n> 參考資料\n>\n> [Laravel — Collection 用途大解析](https://medium.com/johnliu-%E7%9A%84%E8%BB%9F%E9%AB%94%E5%B7%A5%E7%A8%8B%E6%80%9D%E7%B6%AD/laravel-collection-%E7%94%A8%E9%80%94%E5%A4%A7%E8%A7%A3%E6%9E%90-1e2dbc6e2c93)\n\n### 運算類\n\n方便進行數學運算，或是判斷是否含有特定值，也能比較兩個 collection 之間的不同\n\n#### Integer\n\n##### `count` 計數\n\n```php\n$collection = collect([1, 2, 3, 4]);\n\n$collection->count();\n\n// 4\n```\n\n#### Boolean\n\n##### `contains` 判斷集合是否包含指定的條件\n\n傳入值\n\n```php\n$collection = collect(['name' => 'Desk', 'price' => 100]);\n\n$collection->contains('Desk');\n\n// true\n\n$collection->contains('New York');\n\n// false\n```\n\n傳入陣列\n\n```php\n$collection = collect([\n    ['product' => 'Desk', 'price' => 200],\n    ['product' => 'Chair', 'price' => 100],\n]);\n\n$collection->contains('product', 'Bookcase');\n\n// false\n```\n\n傳遞匿名函數\n\n```php\n$collection = collect([1, 2, 3, 4, 5]);\n\n$collection->contains(function ($value, $key) {\n    return $value > 5;\n});\n\n// false\n```\n\n- `containsStrict()` 方法和 `contains()` 類似，但他在比較時更嚴格。\n\n#### Array\n\n##### `diff` 比較集合或陣列的值\n\n返回不存在此方法參數中的值\n\n```php\n$diff = collect([1, 2, 3, 4, 5])->diff([2, 4, 6, 8]);\n$diff->all();\n\n// 返回[1, 3, 5]，原集合內與diff方法中相同的數值被剔除。\n```\n\n### 迭代類\n\n#### `filter` 傳入匿名函式篩選集合\n\n返回通過篩選的項目\n\n```php\n$filtered = collect([1, 2, 3, 4])->filter(function (item) {\n    return $item > 2\n});\n\n$filtered->all();\n\n// [3, 4]\n```\n\n#### `map` 遍歷集合\n\n將集合的值透過傳入的匿名函數修改並返回，生成修改過的新集合\n\n```php\n$collection = collect([1, 2, 3, 4, 5]);\n\n$multiplied = $collection->map(function ($item, $key) {\n    return $item * 2;\n});\n\n$multiplied->all();\n\n// [2, 4, 6, 8, 10]\n```\n\n### 分組類\n\n#### `countBy` 計算指定數值\n\n```php\n$collection = collect([1, 2, 2, 2, 3]);\n\n$counted = $collection->countBy();\n\n$counted->all();\n\n// [1 => 1, 2 => 3, 3 => 1]\n```\n\n可以傳入匿名函數來自訂要計數的值\n\n```php\n$collection = collect(['alice@gmail.com', 'bob@yahoo.com', 'carlos@gmail.com']);\n\n$counted = $collection->countBy(function ($email) {\n    return substr(strrchr($email, \"@\"), 1);\n});\n\n$counted->all();\n\n// ['gmail.com' => 2, 'yahoo.com' => 1]\n```\n\n### 變形類\n\n將 collection 改變資料結構\n\n#### 維度與順序\n\n##### `collapse` , `flatten`\n\n兩者都是將維度從多維降為一維，collapse 較適用 Array 形式的資料，flatten 更適合有 Key-Value 形式的資料。\n兩個函式的用途，都是將例如 [[1,2,3], [4,5,6]] 轉變成 [1,2,3,4,5,6]\n\n##### `sort` 將陣列重新排列\n\n```php\nuse Illuminate\\Support\\Arr;\n\n$array = ['Desk', 'Table', 'Chair'];\n\n$sorted = Arr::sort($array);\n\n// ['Chair', 'Desk', 'Table']\n```\n\n根據傳入匿名函數返回的結果，對陣列進行排序\n\n```php\nuse Illuminate\\Support\\Arr;\n\n$array = [\n    ['name' => 'Desk'],\n    ['name' => 'Table'],\n    ['name' => 'Chair'],\n];\n\n$sorted = array_values(Arr::sort($array, function ($value) {\n    return $value['name'];\n}));\n\n/*\n    [\n        ['name' => 'Chair'],\n        ['name' => 'Desk'],\n        ['name' => 'Table'],\n    ]\n*/\n```\n\n利用 key 值替陣列排序\n\n```php\n$list = [\n  5 => 1\n  4 => 2\n  2 => 4\n  1 => 5\n  6 => 6\n];\n\nArr::sort($list, function ($value, $key) {\n    return $key;\n})\n```\n\n輸出\n\n```txt\narray:5 [\n  1 => 5\n  2 => 4\n  4 => 2\n  5 => 1\n  6 => 6\n]\n```\n\n#### 組合\n\n##### `combine` 將一個集合的值作為 key，用來和另一陣列或集合的值進行組合\n\n```php\n$collection = collect(['name', 'age']);\n\n$combined = $collection->combine(['George', 29]);\n\n$combined->all();\n\n// ['name' => 'George', 'age' => 29]\n```\n\n##### `merge` 合併指定的陣列或是集合到原集合\n\n若傳入的集合中的 key 值與原集合中的 key 值相同，則傳入的值將會將原集合中的值覆蓋。\n\n```php\n$collection = collect(['product_id' => 1, 'price' => 100]);\n\n$merged = $collection->merge(['price' => 200, 'discount' => false]);\n\n$merged->all();\n\n// ['product_id' => 1, 'price' => 200, 'discount' => false]\n```\n\n若傳入的集合項為數字，則這些值將會追加在集合的最後面。\n\n```php\n$collection = collect(['Desk', 'Chair']);\n\n$merged = $collection->merge(['Bookcase', 'Door']);\n\n$merged->all();\n\n// ['Desk', 'Chair', 'Bookcase', 'Door']\n```\n\n##### `concat` 將傳入的值追加到集合的末端\n\n```php\n$collection = collect(['John Doe']);\n\n$concatenated = $collection->concat(['Jane Doe'])->concat(['name' => 'Johnny Doe']);\n\n$concatenated->all();\n\n// ['John Doe', 'Jane Doe', 'Johnny Doe']\n```\n\n##### `push` 把指定的值加入集合的末端\n\n```php\n$collection = collect([1, 2, 3, 4]);\n$collection->push(5);\n$collection->all();\n\n// [1, 2, 3, 4, 5]\n```\n\n##### `prepend` 將指定的值加入集合的開頭\n\n```php\n$collection = collect([1, 2, 3, 4, 5]);\n\n$collection->prepend(0);\n\n$collection->all();\n\n// [0, 1, 2, 3, 4, 5]\n```\n\n#### 擷取\n\n##### `except` 擷取除了 a, b 以外的\n\n##### `only` 只擷取 a, b\n\n##### `get` 取得特定 key 的值\n\n##### `forget` 直接刪除指定 key 值對應的 value\n\n##### `pull` 和 `get` 雷同，會修改原本的 collection\n\n##### `pluck` 取得集合中所有陣列的 key 值\n\n```php\n$collection = collect([\n    ['product_id' => 'prod-100', 'name' => 'Desk'],\n    ['product_id' => 'prod-200', 'name' => 'Chair'],\n])\n\n$picked = $collection->pluck('name');\n\n$pluck->all();\n\n// ['Desk', 'Chair']\n```\n\n##### `intersect` 從原集合中移除在指定陣列中或集合中不存在的值\n\n```php\n$collection = collect(['a', 'b', 'c']);\n$intersect = $collection->intersect(['a', 'c', 'e', 'f']);\n$intersect->all(); // [0 => 'a', 2 => 'c']\n```\n\n##### `keys`, `values` 取出集合中的 key 或 value\n\n#### 轉型\n\n##### `toArray`, `toJson` 提供轉成陣列或是 json 等常用格式\n\n### Where\n\ncollection 和 laravel 本身的 ORM 系統 Eloquent 密不可分，因此也配合支援許多 where 語法，使用方法類似 MySQL。\n\n#### 'first' 返回陣列中指令條件的第一元素\n\n```php\ncollect([1, 2, 3, 4, 5, 6])->first(function ($value, $key) {\n    return $value > 2;\n});\n\n// 3\n```\n\n若 `first` 方法不傳入參數，則返回集合中第一元素。若集合為空，則返回 `null`\n\n```php\ncollect([1, 2])->first();\n\n// 1\n```\n\n### 軟體操作類\n\n#### `collect` 複製一個新的 collection，記憶體位置不衝突\n\n## Helper 輔助函數\n\n### `Arr::add` 將數值加入陣列\n\n```php\nuse Illuminate\\Support\\Arr;\n\n$array = Arr::add(['name' => 'Desk'], 'price', 100);\n\n// ['name' => 'Desk', 'price' => 100]\n\n$array = Arr::add(['name' => 'Desk', 'price' => null], 'price', 100);\n\n// ['name' => 'Desk', 'price' => 100]\n\n```\n\n### `after` 返回傳入的字串的值後面所有的內容\n\n如果傳入的值不存在，將返回整個字串\n\n```php\nuse Illuminate\\Support\\Str;\n\n$slice = Str::of('This is my name')->after('This is');\n\n// ' my name'\n```\n","tocContent":"- [Laravel Collections \\& Helper](#laravel-collections--helper)\n  - [Collections 集合](#collections-集合)\n    - [運算類](#運算類)\n      - [Integer](#integer)\n        - [`count` 計數](#count-計數)\n      - [Boolean](#boolean)\n        - [`contains` 判斷集合是否包含指定的條件](#contains-判斷集合是否包含指定的條件)\n      - [Array](#array)\n        - [`diff` 比較集合或陣列的值](#diff-比較集合或陣列的值)\n    - [迭代類](#迭代類)\n      - [`filter` 傳入匿名函式篩選集合](#filter-傳入匿名函式篩選集合)\n      - [`map` 遍歷集合](#map-遍歷集合)\n    - [分組類](#分組類)\n      - [`countBy` 計算指定數值](#countby-計算指定數值)\n    - [變形類](#變形類)\n      - [維度與順序](#維度與順序)\n        - [`collapse` , `flatten`](#collapse--flatten)\n        - [`sort` 將陣列重新排列](#sort-將陣列重新排列)\n      - [組合](#組合)\n        - [`combine` 將一個集合的值作為 key，用來和另一陣列或集合的值進行組合](#combine-將一個集合的值作為-key用來和另一陣列或集合的值進行組合)\n        - [`merge` 合併指定的陣列或是集合到原集合](#merge-合併指定的陣列或是集合到原集合)\n        - [`concat` 將傳入的值追加到集合的末端](#concat-將傳入的值追加到集合的末端)\n        - [`push` 把指定的值加入集合的末端](#push-把指定的值加入集合的末端)\n        - [`prepend` 將指定的值加入集合的開頭](#prepend-將指定的值加入集合的開頭)\n      - [擷取](#擷取)\n        - [`except` 擷取除了 a, b 以外的](#except-擷取除了-a-b-以外的)\n        - [`only` 只擷取 a, b](#only-只擷取-a-b)\n        - [`get` 取得特定 key 的值](#get-取得特定-key-的值)\n        - [`forget` 直接刪除指定 key 值對應的 value](#forget-直接刪除指定-key-值對應的-value)\n        - [`pull` 和 `get` 雷同，會修改原本的 collection](#pull-和-get-雷同會修改原本的-collection)\n        - [`pluck` 取得集合中所有陣列的 key 值](#pluck-取得集合中所有陣列的-key-值)\n        - [`intersect` 從原集合中移除在指定陣列中或集合中不存在的值](#intersect-從原集合中移除在指定陣列中或集合中不存在的值)\n        - [`keys`, `values` 取出集合中的 key 或 value](#keys-values-取出集合中的-key-或-value)\n      - [轉型](#轉型)\n        - [`toArray`, `toJson` 提供轉成陣列或是 json 等常用格式](#toarray-tojson-提供轉成陣列或是-json-等常用格式)\n    - [Where](#where)\n      - ['first' 返回陣列中指令條件的第一元素](#first-返回陣列中指令條件的第一元素)\n    - [軟體操作類](#軟體操作類)\n      - [`collect` 複製一個新的 collection，記憶體位置不衝突](#collect-複製一個新的-collection記憶體位置不衝突)\n  - [Helper 輔助函數](#helper-輔助函數)\n    - [`Arr::add` 將數值加入陣列](#arradd-將數值加入陣列)\n    - [`after` 返回傳入的字串的值後面所有的內容](#after-返回傳入的字串的值後面所有的內容)"}