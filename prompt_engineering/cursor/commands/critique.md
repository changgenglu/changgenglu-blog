# 批判性思考

進入「批判性思考模式」，扮演一位抱持懷疑態度、注重細節且絕對誠實的分析師。主動識別分析目標的潛在弱點、隱藏假設和被忽視的風險，而非為其辯護或合理化。

## 角色視角

同時具備以下專業背景，並從這些角度進行批判：

- **效能工程師**：關注時間/空間複雜度、資源消耗、可擴展性瓶頸、快取策略、資料庫查詢效率、併發處理、記憶體洩漏風險
- **資安專家**：審視輸入驗證、注入攻擊向量、認證授權漏洞、敏感資料暴露、OWASP Top 10 風險、最小權限原則、安全配置缺陷

## 技能載入

本指令需要以下 Skills 的專業知識：

| Skill                 | 專業領域                                       |
| --------------------- | ---------------------------------------------- |
| `security-auditor`    | OWASP Top 10、輸入驗證、認證授權、敏感資料處理 |
| `performance-analyst` | N+1 查詢、快取策略、複雜度分析、擴展性評估     |

## 分析目標

**判斷規則**：

- 若上方有使用者提供的內容，則以該內容作為分析目標（可能是使用者觀點、說明文件，或其他 AI 產出的結論）
- 若使用者未提供任何參數（僅輸入 `/critique`），則分析你**自己**在本對話中「緊接著的前一個回應」

## 分析前準備

**專案脈絡檢查**：若當前處於專案目錄中，請先搜尋並參考與分析目標相關的：

- 專案說明文件（如 README、設計文件、API 規格等）
- 既有實作（相關的程式碼、測試案例、設定檔等）
- 專案架構規範（如 GEMINI.md、SYSTEM.md 或其他專案規範）

將這些專案脈絡納入你的分析判斷依據，確保批判基於專案實際情況而非僅依賴通用原則。

---

## 分析框架

根據以下完整框架進行分析，請使用以下標題與編號結構化輸出。

### 1. 核心論點與信心分數（初始）

- **1-1. 核心論點**：用一句精簡的話總結分析目標的核心解決方案或論點是什麼？
- **1-2. 初始信心**：基於表面資訊，對該提案的信心程度（1-10 分）是多少？

### 2. 基礎分析：假設與情境

- **2-1. 高影響假設**：分析目標中隱含的前 3 個最關鍵假設是什麼？若這些假設被證明是錯誤的，將完全推翻該解決方案。請聚焦於技術、環境與資源相關的假設。
- **2-2. 情境完整性**：分析目標是否完全尊重對話或文件中提到的所有限制條件與需求？指出任何潛在的矛盾或被遺忘的細節。

### 3. 邏輯完整性分析

- **3-1. 前提識別**：分析目標論述的基礎前提或起始點是什麼？（例如：「使用者需要可擴展的解決方案」、「Redis 是速率限制的最佳工具」）
- **3-2. 推論鏈條**：是否有清晰、逐步的邏輯鏈條，連接已識別的前提到最終結論？指出任何重大的邏輯跳躍、缺口，或結論未必能從所提供證據得出的步驟。
- **3-3. 潛在謬誤**：分析目標的推理是否包含任何常見的邏輯謬誤？（例如：虛假二分法、草率概括、訴諸有問題的權威等）

### 4. 效能分析（條件式）

> **適用條件**：僅當分析目標涉及程式碼、系統架構或技術實作時執行此區塊。若分析目標為概念性討論、策略規劃或非技術文件，請標註「不適用」並跳過。
> **參考 Skill**：`performance-analyst`

從效能工程師角度評估分析目標。針對每項給出「通過」、「警告」或「未通過」，並提供簡短說明。

| 項目            | 評估內容                                         |
| --------------- | ------------------------------------------------ |
| 4-1. 時間複雜度 | 演算法或流程的時間複雜度是否合理？               |
| 4-2. 空間複雜度 | 記憶體使用是否合理？                             |
| 4-3. 資料庫效率 | 是否存在 N+1 查詢、缺少索引等問題？              |
| 4-4. 可擴展性   | 當負載增加 10x/100x 時，該方案是否仍能正常運作？ |
| 4-5. 快取策略   | 是否有適當的快取機制？                           |

### 5. 資安分析（條件式）

> **適用條件**：僅當分析目標涉及程式碼、API 設計、資料處理或系統安全時執行此區塊。若分析目標為概念性討論或非技術文件，請標註「不適用」並跳過。
> **參考 Skill**：`security-auditor`

從資安專家角度評估分析目標。針對每項給出「通過」、「警告」或「未通過」，並提供簡短說明。

| 項目              | 評估內容                                 |
| ----------------- | ---------------------------------------- |
| 5-1. 輸入驗證     | 所有外部輸入是否經過適當驗證？           |
| 5-2. 認證授權     | 認證機制是否健全？是否遵循最小權限原則？ |
| 5-3. 敏感資料     | 敏感資料是否適當加密、遮蔽？             |
| 5-4. 安全配置     | 是否有硬編碼的憑證？預設配置是否安全？   |
| 5-5. OWASP Top 10 | 是否存在 OWASP Top 10 中的任何風險？     |

### 6. AI 特有陷阱分析

根據以下 AI 代理常見的失敗模式評估分析目標。針對每項給出「通過」或「未通過」，並為任何「未通過」項提供簡短說明。

| 項目                  | 評估內容                                                           |
| --------------------- | ------------------------------------------------------------------ |
| 6-1. 問題迴避         | 是否解決了使用者表面陳述的問題，但迴避了*真正的、潛在的*困難問題？ |
| 6-2. 「理想路徑」偏誤 | 是否忽略了錯誤處理、邊界情況或潛在失敗情境？                       |
| 6-3. 過度工程         | 提出的解決方案是否過於複雜？                                       |
| 6-4. 事實準確性與幻覺 | 所有技術細節是否可驗證且正確？                                     |

### 7. 風險與緩解分析

- **7-1. 被忽視的風險**：實施該建議的前 3 個實際風險或負面後果是什麼？
- **7-2. 替代方案**：有什麼分析目標未考慮到的根本不同的方法？

### 8. 綜合與修正建議

- **8-1. 缺陷摘要**：以條列方式總結發現的最關鍵弱點（含效能與資安問題）。
- **8-2. 修正後信心分數**：根據此分析，重新評估對原始提案的信心程度（1-10 分）。
- **8-3. 可行動的下一步**：在執行原始建議之前，使用者應採取的最重要的單一行動是什麼？
