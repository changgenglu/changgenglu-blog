# Gemini CLI Custom Command: /pint
# Location: ~/.gemini/commands/pint.toml (User Scope) or .gemini/commands/pint.toml (Project Scope)

description = "å°èˆ‡ master åˆ†æ”¯æœ‰å·®ç•°çš„ PHP æª”æ¡ˆåŸ·è¡Œ Laravel Pint (åŸ·è¡Œæ–¼ backend838 å®¹å™¨)"

prompt = """
ä½ æœƒå”åŠ©åŸ·è¡Œ pint å°‡æœ‰ä¿®æ”¹çš„æª”æ¡ˆé€²è¡Œæ ¼å¼åŒ–ã€‚

**æ³¨æ„**: pint æŒ‡ä»¤å¿…é ˆåœ¨ `backend838` Podman å®¹å™¨å…§åŸ·è¡Œã€‚è«‹ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š
```bash
podman exec backend838 sh -c "cd /var/www/html/eagle && xargs /var/www/html/eagle/vendor/bin/pint --config=pint.json
```


# 1. æ‰¾å‡ºèˆ‡ master çš„å…±åŒç¥–å…ˆ
MERGE_BASE=$(git merge-base master HEAD)

# 2. æ‰¾å‡ºå·®ç•°æª”æ¡ˆ (Added, Copied, Modified, Renamed)
PHP_FILES=$(git diff --name-only --diff-filter=ACMR "$MERGE_BASE" HEAD | grep ".php$")

# 3. åˆ¤æ–·ä¸¦åŸ·è¡Œ
if [ -n "$PHP_FILES" ]; then
    echo "ğŸ” Found modified PHP files:"
    echo "$PHP_FILES"
    echo "-----------------------------------"
    # é€é xargs å‚³éæª”æ¡ˆåˆ—è¡¨é€²å…¥å®¹å™¨åŸ·è¡Œ pint
    # æ³¨æ„ï¼šä½¿ç”¨ xargs -r é¿å…ç©ºåƒæ•¸åŸ·è¡Œï¼Œé›–ç„¶å¤–å±¤å·²æœ‰ if åˆ¤æ–·ï¼Œä½†ç‚ºäº†å¥å£¯æ€§ä¿ç•™
    echo "$PHP_FILES" | xargs -r podman exec backend838 sh -c "cd /var/www/html/eagle && xargs /var/www/html/eagle/vendor/bin/pint --config=pint.json"
else
    echo "âœ… No PHP files changed relative to master. No formatting needed."
fi

"""