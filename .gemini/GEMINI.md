# Gemini 核心原則

> 本文件為 gemini-cli 的通用核心原則，適用於多專案、多語言環境。
> 具體的程式碼風格、審查規範、規劃流程等，請參閱 `.gemini/commands/` 目錄下的各指令定義。

---

## 1. 語言規範（最高優先級）

### 1.1 輸出語言
- **絕對規則**：所有人類可讀輸出必須使用 **繁體中文（臺灣用語）**
- **適用範圍**：
  - 對話回應
  - 規劃文件、任務清單
  - 狀態更新、思考摘要
  - 文件內容（如 `implementation_plan.md`）

### 1.2 例外情況
- 工具參數（技術鍵值、ID、檔名）
- 程式碼語法（變數名、函數名、路徑）
- SQL 查詢、Shell 指令

---

## 2. 專案規範優先（Source of Truth）

### 2.1 優先參考來源
執行任務前，必須優先讀取專案中的技術文件：

| 優先順序 | 檔案 | 說明 |
|---------|-----|-----|
| 1 | `.cursorrules` | 專案編碼規範 |
| 2 | `CLAUDE.md` | AI 協作準則 |
| 3 | `GEMINI.md` | Gemini 專用準則（若存在） |

### 2.2 規範層級
- 專案規範 > 通用原則
- 若專案規範與通用原則衝突，**以專案規範為準**

### 2.3 術語一致性（DDD）
- 嚴格使用專案中既有的業務術語（如 `Account` vs `User`）
- 禁止自行創造新術語

---

## 3. SOLID 原則遵循

執行任何程式碼生成或審查時，必須遵循 SOLID 原則：

| 原則 | 要求 |
|-----|-----|
| **SRP** | 每個 class/method 單一職責 |
| **OCP** | 透過擴展（Interface）而非修改 |
| **LSP** | 子類可完全替代父類 |
| **ISP** | Interface 精簡（≤ 5 個方法） |
| **DIP** | 依賴抽象，透過 DI 注入 |

---

## 4. 錯誤處理與防循環協議

### 4.1 Read-Before-Write
- 修改檔案前，必須先讀取確認內容
- 禁止基於假設進行修改

### 4.2 防循環機制
- **規則**：若同一工具連續失敗 2 次且錯誤相同，**立即停止**
- **行動**：輸出錯誤報告，請求使用者指引
- **禁止**：無限重試相同操作

### 4.3 錯誤報告格式
```markdown
# 執行阻擋報告
- **錯誤類型**: [描述]
- **失敗次數**: 2
- **嘗試內容**: [操作描述]
- **請求協助**: [需要使用者提供什麼資訊]
```

---

## 5. 行為約束

### 5.1 禁止事項
- ❌ 禁止基於「通用知識」生成程式碼，必須對齊專案規範
- ❌ 禁止擅自添加規劃範圍以外的功能
- ❌ 禁止重構與當前任務無關的程式碼
- ❌ 禁止捏造專案中不存在的檔案或內容

### 5.2 文件參照
- 引用專案程式碼時，標註檔案與行號（如 `UserService.php:45`）
- 禁止使用模糊引用（如「在某個 Service 中」）

---

## 6. 專案記憶

> 此區塊記錄專案特定資訊，由 Gemini 在互動過程中累積。

- Stars 專案的錯誤碼定義於 `resources/lang/en/error.php`
